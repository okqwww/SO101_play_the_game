# IK测试结果可视化分析

## 📊 总体统计

根据50次有效测试数据，生成了以下可视化分析：

### 关键指标
- **成功测试数**: 50/50 (100%)
- **最佳区域占比**: 25/50 (50.0%) - 误差<20mm
- **最佳区域平均误差**: 12.70 mm

### 误差范围
- **IK误差**: 2.99 ~ 79.12 mm
- **电机执行误差**: 4.44 ~ 24.65 mm
- **实际总误差**: 5.68 ~ 79.87 mm

---

## 🗺️ 可视化图表说明

### 1. 3D散点图 (`3d_scatter.png`)
**4个子图，全方位展示误差分布：**
- **左上**: IK误差 - 显示逆运动学计算的精度
- **右上**: 实际误差 - 机械臂实际到达位置的误差
- **左下**: 电机误差 - 电机执行IK结果的误差
- **右下**: 最佳区域 - 绿色=误差<20mm，橙色=20-30mm，红色>30mm

**关键发现：**
- 绿色区域（低误差）主要集中在工作空间的**中央区域**
- 红色区域（高误差）出现在**边缘位置**和**极限距离**

---

### 2. 2D热力图 (`2d_heatmaps.png`)
**6个投影平面，精确定位误差分布：**

#### 实际误差热力图（上排）：
- **XY平面（俯视图）**: 
  - ✅ 中心区域（X=0.23-0.28m, Y=-0.03~0.03m）误差最小
  - ⚠️ 左右边缘（|Y|>0.05m）误差增大
  
- **XZ平面（侧视图）**:
  - ✅ 中等距离（X=0.22-0.30m）+ 中等高度（Z=0.03-0.05m）误差小
  - ⚠️ 极近距离（X<0.20m）和极远距离（X>0.32m）误差大
  
- **YZ平面（正视图）**:
  - ✅ 中心Y区域（-0.03~0.03m）误差普遍较小
  - ⚠️ Z轴对误差的影响较小，但Z<0.02m时误差偏大

#### IK误差热力图（下排）：
- 与实际误差趋势相似，证明**IK精度是主要误差来源**

---

### 3. 误差分布图 (`error_distributions.png`)
**6个子图分析误差特征：**

#### 直方图（上排）：
- **IK误差分布**: 大部分集中在10-30mm，少数异常值>60mm
- **实际误差分布**: 与IK误差类似，呈正偏态分布
- **电机误差分布**: 集中在10-20mm，稳定性较好

#### 坐标轴vs误差散点图（下排）：
- **X轴**: 0.24-0.28m范围误差最小，<0.22m和>0.30m误差显著增大
- **Y轴**: -0.03~0.03m范围误差最小，均匀对称分布
- **Z轴**: 对误差影响相对较小，但Z<0.02m时略有增大

**结论**: X轴距离是影响IK精度的**最关键因素**

---

### 4. 区域箱线图 (`region_boxplots.png`)
**按坐标轴区域对比误差：**

#### X轴区域：
- **近区（0.18-0.21m）**: 中位数~30mm，有较多异常值
- **中区（0.21-0.24m）**: 中位数~15mm，**最优区域**
- **远区（0.24-0.35m）**: 中位数~25mm，误差范围大

#### Y轴区域：
- **右侧（-0.09~-0.03m）**: 中位数~22mm
- **中央（-0.03~0.03m）**: 中位数~18mm，**较优区域**
- **左侧（0.03~0.09m）**: 中位数~20mm

#### Z轴区域：
- 各区域误差相对均衡，无显著差异

**结论**: **中近距离（X=0.21-0.24m）+ 中心区域（Y=-0.03~0.03m）** 是最佳工作区

---

### 5. 最佳区域高亮图 (`best_region_highlight.png`)
**绿色=误差<20mm，红色=误差≥20mm**

#### 最佳区域特征：
- **X范围**: 0.215 ~ 0.333 m（但集中在0.22-0.28m）
- **Y范围**: -0.080 ~ 0.085 m（但集中在-0.04~0.04m）
- **Z范围**: 0.010 ~ 0.056 m（全高度范围）

#### 空间分布：
- **XY平面**: 呈椭圆形分布，中心密集
- **XZ平面**: 中等距离+全高度范围均有绿点
- **YZ平面**: Y轴中心区域绿点最多

---

## 🎯 关键结论与建议

### ✅ 最佳工作区域（误差<15mm）：
```
X: 0.22 - 0.28 m  （距离机器人基座）
Y: -0.03 ~ 0.03 m （中心左右3cm）
Z: 0.02 ~ 0.05 m  （高度2-5cm）
```

### ⚠️ 需要避免的区域（误差>30mm）：
```
X: <0.20m (太近) 或 >0.32m (太远)
Y: <-0.06m 或 >0.06m (左右偏离过大)
Z: <0.015m (贴地过低)
```

### 🤖 针对打地鼠项目的建议：

1. **手机摆放位置**：
   - 建议将手机中心放置在 **X=0.25m, Y=0.00m** 的位置
   - 这样大部分点击目标都会落在最佳区域内

2. **目标选择策略**：
   - 优先点击屏幕中心和靠近中心的目标（高精度）
   - 避免点击屏幕边缘角落的目标（低精度）
   - 可以设置一个"可达性阈值"来过滤边缘目标

3. **IK策略优化**：
   - 实现"两步移动"策略：先移动到最佳区域内的中间点，再移动到目标
   - 这样可以将IK起始点始终控制在高精度区域

4. **误差补偿**：
   - 对于边缘位置，可以考虑添加位置补偿（基于测试数据）
   - 或者采用视觉反馈进行闭环控制

---

## 📈 误差来源分析

### IK误差（主要来源，占70-90%）：
- **原因**: placo迭代求解器局部最优问题
- **影响因素**: 起始关节角度、目标位置、工作空间边界
- **改进方向**: 多次IK尝试、优化初始猜测、增加约束

### 电机执行误差（次要来源，占10-30%）：
- **原因**: 机械间隙、齿轮传动精度、电机控制精度
- **影响因素**: 关节角度变化幅度、运动速度
- **改进方向**: 硬件改进、PID调参

---

## 📂 文件位置

所有可视化图表保存在：
```
outputs/ik_accuracy_test/visualizations/
├── 3d_scatter.png           # 3D空间误差分布
├── 2d_heatmaps.png          # 2D平面热力图
├── error_distributions.png   # 误差统计分布
├── region_boxplots.png      # 区域箱线图对比
└── best_region_highlight.png # 最佳区域高亮
```

原始数据：
```
outputs/ik_accuracy_test/test_results_YYYYMMDD_HHMMSS.csv
```

---

## 🔧 如何使用可视化工具

```bash
# 对任意测试结果生成可视化
conda activate lerobot
python visualize_ik_results.py outputs/ik_accuracy_test/test_results_20260122_150051.csv

# 或者直接运行，自动选择最新结果
python visualize_ik_results.py
```

---

**生成时间**: 2026-01-22  
**测试数据**: 50次随机位置测试  
**机械臂**: SO-ARM101 (placo IK)
